#06_cancer
#09_wine
#10_digits


### 요 파일에 이 2개의 데이터 셋 다 넣어서 23번처럼 맹글기

from sklearn.datasets import load_breast_cancer, load_wine, load_digits
from sklearn.tree import DecisionTreeClassifier
from sklearn.ensemble import RandomForestClassifier, GradientBoostingClassifier
from xgboost import XGBClassifier

#1. data
datasets1 = load_breast_cancer()
datasets2 = load_wine()
datasets3 = load_digits()

data = [datasets1, datasets2, datasets3]
name = ['cancer', 'wine', 'digits']
# x = data.data
# y = data.target

from sklearn.model_selection import train_test_split

random_state=1223

# x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.2, random_state=random_state)

#2. model
model1 = DecisionTreeClassifier(random_state=random_state)
model2 = RandomForestClassifier(random_state=random_state)
model3 = GradientBoostingClassifier(random_state=random_state)
model4 = XGBClassifier(random_state=random_state)

models = [model1, model2, model3, model4]
i=0
for data in data:
    x = data.data
    y = data.target
    x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.1, random_state=random_state)
    from sklearn.preprocessing import MinMaxScaler, StandardScaler
    scaler = StandardScaler()
    x_train = scaler.fit_transform(x_train)
    x_test = scaler.transform(x_test)
    print("===================", name[i] , "====================")
    for model in models :
        model.fit(x_train, y_train)
        print("===================", model.__class__.__name__, "====================")
        print('acc :', model.score(x_test, y_test))
        print(model.feature_importances_)
    i = i+1        
        
"""
=================== cancer ====================
=================== DecisionTreeClassifier ====================    
acc : 0.9298245614035088
[0.         0.00639361 0.         0.         0.         0.
 0.01046548 0.         0.         0.04451306 0.00204158 0.
 0.00837567 0.03346757 0.         0.         0.01618715 0.
 0.         0.         0.01326081 0.04233858 0.         0.09934251 
 0.0028416  0.         0.         0.70562962 0.         0.01514275]
=================== RandomForestClassifier ====================
acc : 0.9824561403508771
[0.01032336 0.01429674 0.0242272  0.06564872 0.00521536 0.02501443
 0.04386496 0.09773562 0.00324672 0.00364132 0.02370795 0.00358133
 0.00723111 0.0285759  0.00448963 0.00506061 0.00602691 0.00326417
 0.00446753 0.00389223 0.08437281 0.01579862 0.14665637 0.12312715
 0.01165522 0.01756141 0.03562563 0.166519   0.00901227 0.00615971]
=================== GradientBoostingClassifier ====================
acc : 0.9649122807017544
[4.90595662e-04 3.46066188e-02 5.16912761e-04 3.63521467e-04
 3.56424823e-03 1.38095235e-03 5.45921617e-03 1.08256346e-01
 1.31996941e-04 1.84282414e-04 2.14103542e-03 3.17079501e-03
 1.21431631e-03 2.00415423e-02 8.19414242e-04 3.07441334e-03
 4.56304532e-03 1.31479405e-05 6.51104778e-04 5.46956660e-03
 2.97111155e-01 3.21512465e-02 6.08670713e-02 5.80755471e-02
 8.88325718e-04 2.21957345e-03 1.73348027e-02 3.31306731e-01
 7.03626678e-04 3.22884937e-03]
=================== XGBClassifier ====================
acc : 0.9824561403508771
[0.02607343 0.02038653 0.         0.02215013 0.01022053 0.00220092
 0.00141792 0.10790693 0.00130236 0.00539147 0.01628085 0.00661785
 0.         0.01250916 0.00486745 0.00619593 0.00238387 0.00102491
 0.00289285 0.00289111 0.16712382 0.01516934 0.1358678  0.03455302
 0.01131251 0.00605373 0.04856189 0.3202589  0.00295162 0.00543315]
 
=================== wine ====================
=================== DecisionTreeClassifier ====================
acc : 1.0
[0.01385775 0.         0.         0.         0.03663197 0.
 0.40606987 0.         0.         0.0974218  0.04657388 0.
 0.39944473]
=================== RandomForestClassifier ====================
acc : 1.0
[0.11080766 0.02499996 0.01348983 0.03192336 0.03004375 0.05714636
 0.15504742 0.01256475 0.01815644 0.17422525 0.09020784 0.11166571
 0.16972167]
=================== GradientBoostingClassifier ====================
acc : 1.0
[0.00225925 0.04774937 0.00960122 0.00859398 0.00081557 0.00048954
 0.30854925 0.00207112 0.         0.32597889 0.00354885 0.00579269
 0.28455028]
=================== XGBClassifier ====================
acc : 0.9444444444444444
[0.02770095 0.09263641 0.02949728 0.00684643 0.05519828 0.02268607
 0.28609523 0.00159859 0.         0.24649696 0.01088144 0.02789173
 0.19247064]
 
=================== digits ====================
=================== DecisionTreeClassifier ====================
acc : 0.8444444444444444
[0.         0.         0.00301978 0.00315253 0.00575128 0.04529756
 0.00136203 0.         0.         0.         0.02848824 0.00206178
 0.00723776 0.02289353 0.00131575 0.         0.         0.00132265
 0.00926552 0.02854576 0.04315804 0.0857945  0.00160361 0.
 0.         0.01099059 0.06551297 0.04857953 0.05222305 0.00642695
 0.01289699 0.         0.         0.05913635 0.00645154 0.00068726
 0.07871514 0.02556639 0.0085648  0.         0.         0.00317811
 0.07667943 0.06355171 0.00824713 0.00262409 0.00395944 0.
 0.         0.         0.01127385 0.00496608 0.00631629 0.00503835
 0.03257527 0.00068726 0.         0.00271207 0.01434753 0.00171815
 0.0598589  0.0257965  0.00254287 0.0079051 ]
=================== RandomForestClassifier ====================
acc : 0.9611111111111111
[0.00000000e+00 2.27255374e-03 2.39409828e-02 9.74782341e-03
 9.82864541e-03 2.15818480e-02 9.38757634e-03 9.04124415e-04
 3.44737020e-05 1.13604400e-02 2.26963485e-02 7.30694430e-03
 1.22274358e-02 3.20217428e-02 4.90199097e-03 6.52085082e-04
 2.59927619e-05 8.57233696e-03 2.09972208e-02 2.74905815e-02
 2.85842804e-02 5.18454176e-02 1.00426676e-02 4.01521936e-04
 3.88537353e-05 1.39585435e-02 4.27014098e-02 2.70785396e-02
 2.95212069e-02 2.27825980e-02 3.02504257e-02 0.00000000e+00
 0.00000000e+00 2.85987443e-02 2.66123542e-02 1.88222442e-02
 4.13541302e-02 1.64535185e-02 2.48991464e-02 0.00000000e+00
 1.10801840e-04 1.18413235e-02 3.80324750e-02 4.51863797e-02
 1.86937781e-02 1.96939666e-02 1.98331096e-02 2.13981323e-05
 6.87543264e-06 2.14131393e-03 1.78026945e-02 1.84267237e-02
 1.47624491e-02 2.04667589e-02 2.66593345e-02 1.58749974e-03
 2.29105883e-05 1.44583541e-03 2.00160596e-02 1.01661179e-02
 2.07438790e-02 3.15202026e-02 1.84719635e-02 2.44939916e-03]
=================== GradientBoostingClassifier ====================
acc : 0.9555555555555556
[0.00000000e+00 5.75060794e-04 9.74572669e-03 2.95111413e-03
 2.54992228e-03 6.26189550e-02 1.99726339e-03 2.54047658e-03
 3.47058204e-04 8.95274707e-04 1.84708640e-02 9.40917717e-04
 8.39452271e-03 1.18682094e-02 4.05059329e-03 3.33864377e-04
 2.67191801e-04 2.79034482e-03 1.16917860e-02 4.27913739e-02
 1.52157705e-02 8.87376394e-02 5.20953365e-03 1.44226691e-04
 2.06166483e-06 4.70701397e-04 4.94543804e-02 1.50529748e-02
 3.25595397e-02 2.44345067e-02 1.23013175e-02 4.14143772e-06
 0.00000000e+00 6.28254238e-02 3.13636045e-03 7.85590513e-03
 7.41988864e-02 1.38151887e-02 1.82008425e-02 0.00000000e+00
 1.82238660e-05 5.60494239e-03 7.89430341e-02 7.16333545e-02
 1.12734275e-02 2.01572756e-02 2.40658476e-02 7.08583819e-04
 5.88948837e-07 2.14958254e-03 3.78992235e-03 1.92697687e-02
 6.21028628e-03 1.24994294e-02 2.42989800e-02 5.32833005e-05
 5.56699320e-04 4.71484284e-04 1.36220223e-02 1.41859374e-03
 5.71917242e-02 8.24675496e-03 2.00197192e-02 8.35655059e-03]
=================== XGBClassifier ====================
acc : 0.9611111111111111
[0.         0.01946911 0.00821563 0.00974426 0.00545278 0.04068129
 0.00777098 0.01075119 0.         0.0115265  0.01242939 0.00501457
 0.00872734 0.01377498 0.01350018 0.         0.         0.00611859
 0.00639611 0.03484571 0.01056839 0.05323378 0.00217539 0.
 0.         0.00456139 0.03461033 0.00948497 0.03913957 0.0240031
 0.02004717 0.         0.         0.068833   0.00353546 0.01185721
 0.06383052 0.01085939 0.03731859 0.         0.         0.01043534
 0.03316827 0.04474401 0.01305686 0.02016521 0.02553137 0.
 0.         0.00485397 0.00491258 0.01201542 0.01030054 0.01420349
 0.02968409 0.00504113 0.         0.00160524 0.01139932 0.00304591
 0.0772557  0.00953228 0.03498071 0.02559159]
"""